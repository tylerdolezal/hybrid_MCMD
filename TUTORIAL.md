# Hybrid MCMD Input File Tutorial

This tutorial explains the structure and usage of the `input_file` for the **Hybrid Monte Carlo Molecular Dynamics (MCMD) Routine**. It can be manually edited or populated using `gui.py`.

## `GUI.py` Demonstration
https://github.com/user-attachments/assets/73e5ef03-db30-4c4b-9554-cb763c016794

## Overview
The input file contains key parameters that define the simulation settings, including composition, crystal structure, Monte Carlo (MC) and Molecular Dynamics (MD) parameters, and additional modifiers like grain boundaries, vacancies, and additives.

Each line in the file follows a `key: value` format, where:
- Keys define the parameter type.
- Values specify the corresponding settings.

## Parameter Descriptions

### Composition
```plaintext
composition: Ni=0.7, Cr=0.3
```
Defines the atomic fraction of elements in the system. In this case, the system contains **70% Ni and 30% Cr**.

### Crystal Shape
```plaintext
crystal_shape: fcc
```
Defines the crystal structure of the simulation cell. Options include **fcc (Face-Centered Cubic), bcc (Body-Centered Cubic), and hcp (Hexagonal Close-Packed)**. The routine will automatically generate an initial randomized bulk structure at the target composition.

### Grain Boundary
```plaintext
grain_boundary: False
```
Specifies whether a grain boundary is included in the simulation. Set to `True` to enable grain boundary modeling. If enabled, `POSCAR-gb` must exist as a predefined grain boundary structure generated by the user before execution.

### Randomization
```plaintext
randomize: False
```
For grain boundary simulations, this determines whether the lattice should be decorated randomly at the target composition while preserving the existing geometry.

### MD Parameters
```plaintext
md_params: 1000, 1073, pfp
```
Defines the **MD execution settings**:
- `1000` – Number of MD steps per MD simulation. Set to 0 for pure MC runs.
- `1073` – Target temperature in Kelvin.
- `pfp` – Interatomic potential used for MD calculations (e.g., `pfp`, `chgnet`, `eam`, `meam`).

### Monte Carlo Parameters
```plaintext
num_mc_steps: 6000
```
Sets the number of Monte Carlo steps to be performed.

```plaintext
md_interval: 100
```
Determines how often MD simulations are executed within the hybrid routine. Set to `num_mc_steps+1` for pure MC runs.

### Simulation Cell Size
```plaintext
size: 6
```
Defines the size of the supercell in terms of unit cell repetitions.

### Execution Command
```plaintext
supcomp_command: lmp_serial
```
Defines the command to execute the LAMMPS simulation. For parallel LAMMPS execution, this could be something like `mpirun -np 8 lmp_mpi`.

### Continue Previous Run
```plaintext
continue_run: False
```
Indicates whether the simulation should resume from a previous run.

### Additives (Dopants)
```plaintext
additives: None or a list [(Cr, B, 9), ...]
```

For undoped simulations, set to `None`. Otherwise, specify a list of host-dopant pairs. Examples include:

- `(Cr, C, 9)`: Adds 9 units of Cr-C pairs.
- `(Ti, B2, 9)`: Adds 9 Ti atoms, each bound to 2 B atoms (18 B atoms total).
- `(None, H, #)`: Introduces H atoms as free interstitials.
- For a system with all of these present, we'd provided, `additives: [(Cr, C, 9), (Ti, B2, 9), (None, H, 20)]`

**Important Notes:**
- The routine currently supports **only X or X2 interstitials**, meaning dopant pairs with more than two interstitials (e.g., `CrO4`) **are not implemented**.
- The interstitial species is **user-defined**, and the algorithm does not impose restrictions on atomic size.
- Interstitials are placed **in the interstitial medium**, meaning **larger atoms (e.g., Si) will also be treated as interstitials**, regardless of their traditional lattice role.
- **Warning**: Do not specify an interstitial species that is also present as a metal lattice species. The algorithm will ignore its on-lattice positions and attempt to move it only as an interstitial, which may lead to unintended behavior.

### Vacancies
```plaintext
vacancies: False
```
Specifies whether atomic vacancies should be introduced in the simulation. If `True`, the algorithm removes atoms from the majority element and disperses the vacancies to prevent clustering.

### Metal Library (work in progress)
```plaintext
metal_library: None or a list of elements to flip to [Cr, Fe, Mo, Nb, Ni, Ti, etc]
```
Defines a set of metallic elements available for swapping or selection. If `None`, metal flips are disabled. The user must provide **POSCAR reference structures** in `src/chemical_potentials/` as `{metal1}{metal2}_POSCAR` (e.g., `CrNi_POSCAR`, always alphabetized). The algorithm uses the majority element as the primary reference and extracts chemical potential energies for all other metallic constituents.

### Surface Properties
```plaintext
surface: None or a list [O, hexagonal, 7.0]
```
Defines surface conditions. Set to `None` if interstitial adsorption and inward diffusion is not being studied. Example:
- `O, hexagonal, 7.0`: A sheet of oxygen (`O`) placed above a hexagonal surface where **7.0 Å** defines the upper limit allowed for the z-coordinate of atoms to use in applying a frozen substrate layer (e.g., atoms at and below 7 Å will be frozen).
- The logic accepts either `hexagonal` or `square`.

**Important Notes:**
If the provided simulation cell does not contain a vacuum in the z direction, a 50 Å vacuum will automatically be added before introducing the sheet of adsorbates to the surface model. 
  - The height of the adsorbate sheet is determined using the van der Waals radius of the adsorbate and the metal elements present in the surface model.
  - The spacing between adsorbates in the sheet is determined using the van der Waals radius of the adsorbates.

### Batch Mode
The `batch_mode` setting allows users to iterate through compositions or to perform multiple simulations at a given composition:

- `batch_mode: [0.01, 0.02, 0.04, 0.05]`: Iterates from 1 at% up to 5 at% of the given additive(s).
- `batch_mode: [0.01, 0.01, 0.01]`: Performs three simulations at 1 at% and records the data for statistical analysis.
- `batch_mode: None`: Performs a single simulation with the given settings.

When `batch_mode` is activated the data and structures are saved to the directory `Alloy_X{at%}_run{iteration}`. So a repeated batch at 1 at% of B would look like, `Alloy_B1_run1`, `Alloy_B1_run2`, etc. For undoped simulations, provide a list of values such that `len() = number of iterations to perform` and the data will be saved as `Alloy_run1`, ..., `Alloy_runN`.

## Usage Notes
- Ensure proper syntax to avoid parsing errors.
- Commented lines can be uncommented (`#` removed) to enable specific features.
- Default values should be reviewed to align with the intended study parameters.

---
This guide provides a structured explanation of the `input_file` format and its parameters. For modifications, ensure consistency with the expected input syntax.
